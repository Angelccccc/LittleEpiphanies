<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>little epiphanies</title>
    <link rel="stylesheet" href="style.css" />
    <link href="https://fonts.googleapis.com/css2?family=Inter&family=Playfair+Display:wght@600&display=swap"
        rel="stylesheet">
    <meta name="description" content="Because what is life without a little bit of reflection and fun." />
</head>

<body>
    <header class="site-header">
        <h1>little epiphanies</h1>
        <p class="tagline">notes & small epiphanies</p>
    </header>

    <main class="container">
        <p class="lede">
            I jot down small moments, ideas, and technical notes—nothing fancy, just
            honest reflections collected over time.
        </p>

        <h2>Archive</h2>
        <div id="archive"></div>
    </main>


    <footer class="site-footer container">
        <small>© <span id="year"></span> Me</small>
    </footer>

    <script>
        // Footer year
        document.getElementById('year').textContent = new Date().getFullYear();

        (async function () {
            const res = await fetch('posts.json', { cache: 'no-store' });
            const posts = await res.json();

            // Sort newest first using ISO string (safe)
            posts.sort((a, b) => b.date.localeCompare(a.date));

            // Group by Year -> Month from the ISO string
            const groups = {};
            for (const p of posts) {
                const [y, m] = String(p.date).trim().slice(0, 10).split('-'); // ["2025","09","03"]
                (groups[y] ||= {})[m] ||= [];
                groups[y][m].push(p);
            }

            const root = document.getElementById('archive');
            const years = Object.keys(groups).sort((a, b) => b.localeCompare(a));

            for (const year of years) {
                const section = document.createElement('section');
                section.innerHTML = `<h2>${year}</h2>`;

                const months = Object.keys(groups[year]).sort((a, b) => b.localeCompare(a)); // "12".."01"
                for (const month of months) {
                    // Month name via local constructor (no UTC shift)
                    const monthName = new Date(Number(year), Number(month) - 1, 1)
                        .toLocaleString(undefined, { month: 'long' });

                    const listItems = groups[year][month].map(p => {
                        // Pretty label via local constructor (no UTC shift)
                        const [yy, mm, dd] = p.date.split('-');
                        const pretty = new Date(Number(yy), Number(mm) - 1, Number(dd))
                            .toLocaleDateString(undefined, { month: 'short', day: '2-digit' });

                        return `<li><a href="${p.path}">${pretty} — ${p.title}</a></li>`;
                    }).join('');

                    section.insertAdjacentHTML('beforeend', `
          <h3 id="${year}-${month}">${monthName}</h3>
          <ul class="post-list">${listItems}</ul>
        `);
                }

                root.appendChild(section);
            }
        })();
    </script>

</body>

</html>